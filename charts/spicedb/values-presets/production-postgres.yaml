# Production PostgreSQL: 2 replicas, TLS enabled, PDB, JSON logging
# Prerequisites: PostgreSQL instance, K8s secret (datastore-uri, preshared-key), TLS certificates (see README)
# Usage: helm install NAME . -f values-presets/production-postgres.yaml --set config.existingSecret=SECRET

replicaCount: 2

config:
  datastoreEngine: postgres
  existingSecret: ""

logging:
  level: info
  format: json

resources:
  requests:
    cpu: 500m
    memory: 1Gi
  limits:
    cpu: 2000m
    memory: 4Gi

tls:
  enabled: true
  grpc:
    secretName: spicedb-tls
    certPath: /etc/spicedb/tls/grpc/tls.crt
    keyPath: /etc/spicedb/tls/grpc/tls.key
    caPath: /etc/spicedb/tls/grpc/ca.crt
  http:
    secretName: spicedb-tls
    certPath: /etc/spicedb/tls/http/tls.crt
    keyPath: /etc/spicedb/tls/http/tls.key

podDisruptionBudget:
  enabled: true
  maxUnavailable: 1

autoscaling:
  enabled: false

migrations:
  enabled: true
  logLevel: info

monitoring:
  enabled: true
  serviceMonitor:
    enabled: false
    interval: 30s
    scrapeTimeout: 10s
